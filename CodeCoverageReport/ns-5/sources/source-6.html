


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1252"> 
  <title>Coverage Report > Stopwatch</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.google.maps.internal.ratelimiter</a>
</div>

<h1>Coverage Summary for Class: Stopwatch (com.google.maps.internal.ratelimiter)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">Stopwatch</td>
<td class="coverageStat">
  <span class="percent">
    33.3%
  </span>
  <span class="absValue">
    (5/15)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    8.7%
  </span>
  <span class="absValue">
    (2/23)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    19.6%
  </span>
  <span class="absValue">
    (10/51)
  </span>
</td>
</tr>
  <tr>
    <td class="name">Stopwatch$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    31.2%
  </span>
  <span class="absValue">
    (5/16)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    8.7%
  </span>
  <span class="absValue">
    (2/23)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    19.2%
  </span>
  <span class="absValue">
    (10/52)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * Copyright (C) 2008 The Guava Authors
&nbsp; *
&nbsp; * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except
&nbsp; * in compliance with the License. You may obtain a copy of the License at
&nbsp; *
&nbsp; * http://www.apache.org/licenses/LICENSE-2.0
&nbsp; *
&nbsp; * Unless required by applicable law or agreed to in writing, software distributed under the License
&nbsp; * is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
&nbsp; * or implied. See the License for the specific language governing permissions and limitations under
&nbsp; * the License.
&nbsp; */
&nbsp;/*
&nbsp; * Copyright 2017 Google Inc. All rights reserved.
&nbsp; *
&nbsp; *
&nbsp; * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this
&nbsp; * file except in compliance with the License. You may obtain a copy of the License at
&nbsp; *
&nbsp; *     http://www.apache.org/licenses/LICENSE-2.0
&nbsp; *
&nbsp; * Unless required by applicable law or agreed to in writing, software distributed under
&nbsp; * the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
&nbsp; * ANY KIND, either express or implied. See the License for the specific language governing
&nbsp; * permissions and limitations under the License.
&nbsp; */
&nbsp;
&nbsp;package com.google.maps.internal.ratelimiter;
&nbsp;
&nbsp;import static com.google.maps.internal.ratelimiter.Preconditions.checkNotNull;
&nbsp;import static com.google.maps.internal.ratelimiter.Preconditions.checkState;
&nbsp;import static java.util.concurrent.TimeUnit.DAYS;
&nbsp;import static java.util.concurrent.TimeUnit.HOURS;
&nbsp;import static java.util.concurrent.TimeUnit.MICROSECONDS;
&nbsp;import static java.util.concurrent.TimeUnit.MILLISECONDS;
&nbsp;import static java.util.concurrent.TimeUnit.MINUTES;
&nbsp;import static java.util.concurrent.TimeUnit.NANOSECONDS;
&nbsp;import static java.util.concurrent.TimeUnit.SECONDS;
&nbsp;
&nbsp;import java.util.concurrent.TimeUnit;
&nbsp;
&nbsp;/**
&nbsp; * An object that measures elapsed time in nanoseconds. It is useful to measure elapsed time using
&nbsp; * this class instead of direct calls to {@link System#nanoTime} for a few reasons:
&nbsp; *
&nbsp; * &lt;ul&gt;
&nbsp; *   &lt;li&gt;An alternate time source can be substituted, for testing or performance reasons.
&nbsp; *   &lt;li&gt;As documented by {@code nanoTime}, the value returned has no absolute meaning, and can only
&nbsp; *       be interpreted as relative to another timestamp returned by {@code nanoTime} at a different
&nbsp; *       time. {@code Stopwatch} is a more effective abstraction because it exposes only these
&nbsp; *       relative values, not the absolute ones.
&nbsp; * &lt;/ul&gt;
&nbsp; *
&nbsp; * &lt;p&gt;Basic usage:
&nbsp; *
&nbsp; * &lt;pre&gt;{@code
&nbsp; * Stopwatch stopwatch = Stopwatch.createStarted();
&nbsp; * doSomething();
&nbsp; * stopwatch.stop(); // optional
&nbsp; *
&nbsp; * long millis = stopwatch.elapsed(MILLISECONDS);
&nbsp; *
&nbsp; * log.info(&quot;time: &quot; + stopwatch); // formatted string like &quot;12.3 ms&quot;
&nbsp; * }&lt;/pre&gt;
&nbsp; *
&nbsp; * &lt;p&gt;Stopwatch methods are not idempotent; it is an error to start or stop a stopwatch that is
&nbsp; * already in the desired state.
&nbsp; *
&nbsp; * &lt;p&gt;When testing code that uses this class, use {@link #createUnstarted(Ticker)} or {@link
&nbsp; * #createStarted(Ticker)} to supply a fake or mock ticker. This allows you to simulate any valid
&nbsp; * behavior of the stopwatch.
&nbsp; *
&nbsp; * &lt;p&gt;&lt;b&gt;Note:&lt;/b&gt; This class is not thread-safe.
&nbsp; *
&nbsp; * &lt;p&gt;&lt;b&gt;Warning for Android users:&lt;/b&gt; a stopwatch with default behavior may not continue to keep
&nbsp; * time while the device is asleep. Instead, create one like this:
&nbsp; *
&nbsp; * &lt;pre&gt;{@code
&nbsp; * Stopwatch.createStarted(
&nbsp; *      new Ticker() {
&nbsp; *        public long read() {
&nbsp; *          return android.os.SystemClock.elapsedRealtimeNanos();
&nbsp; *        }
&nbsp; *      });
&nbsp; * }&lt;/pre&gt;
&nbsp; *
&nbsp; * @author Kevin Bourrillion
&nbsp; */
&nbsp;public final class Stopwatch {
&nbsp;  private final Ticker ticker;
&nbsp;  private boolean isRunning;
&nbsp;  private long elapsedNanos;
&nbsp;  private long startTick;
&nbsp;
&nbsp;  /**
&nbsp;   * Creates (but does not start) a new stopwatch using {@link System#nanoTime} as its time source.
&nbsp;   */
&nbsp;  public static Stopwatch createUnstarted() {
<b class="nc">&nbsp;    return new Stopwatch();</b>
&nbsp;  }
&nbsp;
&nbsp;  /** Creates (but does not start) a new stopwatch, using the specified time source. */
&nbsp;  public static Stopwatch createUnstarted(Ticker ticker) {
<b class="nc">&nbsp;    return new Stopwatch(ticker);</b>
&nbsp;  }
&nbsp;
&nbsp;  /** Creates (and starts) a new stopwatch using {@link System#nanoTime} as its time source. */
&nbsp;  public static Stopwatch createStarted() {
<b class="fc">&nbsp;    return new Stopwatch().start();</b>
&nbsp;  }
&nbsp;
&nbsp;  /** Creates (and starts) a new stopwatch, using the specified time source. */
&nbsp;  public static Stopwatch createStarted(Ticker ticker) {
<b class="nc">&nbsp;    return new Stopwatch(ticker).start();</b>
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  Stopwatch() {</b>
<b class="fc">&nbsp;    this.ticker = Ticker.systemTicker();</b>
<b class="fc">&nbsp;  }</b>
&nbsp;
<b class="nc">&nbsp;  Stopwatch(Ticker ticker) {</b>
<b class="nc">&nbsp;    this.ticker = checkNotNull(ticker, &quot;ticker&quot;);</b>
<b class="nc">&nbsp;  }</b>
&nbsp;
&nbsp;  /**
&nbsp;   * Returns {@code true} if {@link #start()} has been called on this stopwatch, and {@link #stop()}
&nbsp;   * has not been called since the last call to {@code start()}.
&nbsp;   */
&nbsp;  public boolean isRunning() {
<b class="nc">&nbsp;    return isRunning;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Starts the stopwatch.
&nbsp;   *
&nbsp;   * @return this {@code Stopwatch} instance
&nbsp;   * @throws IllegalStateException if the stopwatch is already running.
&nbsp;   */
&nbsp;  public Stopwatch start() {
<b class="pc">&nbsp;    checkState(!isRunning, &quot;This stopwatch is already running.&quot;);</b>
<b class="fc">&nbsp;    isRunning = true;</b>
<b class="fc">&nbsp;    startTick = ticker.read();</b>
<b class="fc">&nbsp;    return this;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Stops the stopwatch. Future reads will return the fixed duration that had elapsed up to this
&nbsp;   * point.
&nbsp;   *
&nbsp;   * @return this {@code Stopwatch} instance
&nbsp;   * @throws IllegalStateException if the stopwatch is already stopped.
&nbsp;   */
&nbsp;  public Stopwatch stop() {
<b class="nc">&nbsp;    long tick = ticker.read();</b>
<b class="nc">&nbsp;    checkState(isRunning, &quot;This stopwatch is already stopped.&quot;);</b>
<b class="nc">&nbsp;    isRunning = false;</b>
<b class="nc">&nbsp;    elapsedNanos += tick - startTick;</b>
<b class="nc">&nbsp;    return this;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Sets the elapsed time for this stopwatch to zero, and places it in a stopped state.
&nbsp;   *
&nbsp;   * @return this {@code Stopwatch} instance
&nbsp;   */
&nbsp;  public Stopwatch reset() {
<b class="nc">&nbsp;    elapsedNanos = 0;</b>
<b class="nc">&nbsp;    isRunning = false;</b>
<b class="nc">&nbsp;    return this;</b>
&nbsp;  }
&nbsp;
&nbsp;  private long elapsedNanos() {
<b class="pc">&nbsp;    return isRunning ? ticker.read() - startTick + elapsedNanos : elapsedNanos;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Returns the current elapsed time shown on this stopwatch, expressed in the desired time unit,
&nbsp;   * with any fraction rounded down.
&nbsp;   *
&nbsp;   * &lt;p&gt;Note that the overhead of measurement can be more than a microsecond, so it is generally not
&nbsp;   * useful to specify {@link TimeUnit#NANOSECONDS} precision here.
&nbsp;   */
&nbsp;  public long elapsed(TimeUnit desiredUnit) {
<b class="fc">&nbsp;    return desiredUnit.convert(elapsedNanos(), NANOSECONDS);</b>
&nbsp;  }
&nbsp;
&nbsp;  /** Returns a string representation of the current elapsed time. */
&nbsp;  @Override
&nbsp;  public String toString() {
<b class="nc">&nbsp;    long nanos = elapsedNanos();</b>
&nbsp;
<b class="nc">&nbsp;    TimeUnit unit = chooseUnit(nanos);</b>
<b class="nc">&nbsp;    double value = (double) nanos / NANOSECONDS.convert(1, unit);</b>
&nbsp;
&nbsp;    // Too bad this functionality is not exposed as a regular method call
<b class="nc">&nbsp;    return Platform.formatCompact4Digits(value) + &quot; &quot; + abbreviate(unit);</b>
&nbsp;  }
&nbsp;
&nbsp;  private static TimeUnit chooseUnit(long nanos) {
<b class="nc">&nbsp;    if (DAYS.convert(nanos, NANOSECONDS) &gt; 0) {</b>
<b class="nc">&nbsp;      return DAYS;</b>
&nbsp;    }
<b class="nc">&nbsp;    if (HOURS.convert(nanos, NANOSECONDS) &gt; 0) {</b>
<b class="nc">&nbsp;      return HOURS;</b>
&nbsp;    }
<b class="nc">&nbsp;    if (MINUTES.convert(nanos, NANOSECONDS) &gt; 0) {</b>
<b class="nc">&nbsp;      return MINUTES;</b>
&nbsp;    }
<b class="nc">&nbsp;    if (SECONDS.convert(nanos, NANOSECONDS) &gt; 0) {</b>
<b class="nc">&nbsp;      return SECONDS;</b>
&nbsp;    }
<b class="nc">&nbsp;    if (MILLISECONDS.convert(nanos, NANOSECONDS) &gt; 0) {</b>
<b class="nc">&nbsp;      return MILLISECONDS;</b>
&nbsp;    }
<b class="nc">&nbsp;    if (MICROSECONDS.convert(nanos, NANOSECONDS) &gt; 0) {</b>
<b class="nc">&nbsp;      return MICROSECONDS;</b>
&nbsp;    }
<b class="nc">&nbsp;    return NANOSECONDS;</b>
&nbsp;  }
&nbsp;
&nbsp;  private static String abbreviate(TimeUnit unit) {
<b class="nc">&nbsp;    switch (unit) {</b>
&nbsp;      case NANOSECONDS:
<b class="nc">&nbsp;        return &quot;ns&quot;;</b>
&nbsp;      case MICROSECONDS:
<b class="nc">&nbsp;        return &quot;\u03bcs&quot;; // ?s</b>
&nbsp;      case MILLISECONDS:
<b class="nc">&nbsp;        return &quot;ms&quot;;</b>
&nbsp;      case SECONDS:
<b class="nc">&nbsp;        return &quot;s&quot;;</b>
&nbsp;      case MINUTES:
<b class="nc">&nbsp;        return &quot;min&quot;;</b>
&nbsp;      case HOURS:
<b class="nc">&nbsp;        return &quot;h&quot;;</b>
&nbsp;      case DAYS:
<b class="nc">&nbsp;        return &quot;d&quot;;</b>
&nbsp;      default:
<b class="nc">&nbsp;        throw new AssertionError();</b>
&nbsp;    }
&nbsp;  }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-11-01 14:27</div>
</div>
</body>
</html>
